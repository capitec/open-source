<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    <title>&#x60;Store&#x60;</title>
    <link type="text/css" rel="stylesheet" href="assets/css/github-markdown.css">
    <link type="text/css" rel="stylesheet" href="assets/css/pilcrow.css">
    <link type="text/css" rel="stylesheet" href="assets/css/hljs-github.min.css"/>
  </head>
  <body>
    <article class="markdown-body"><h1 id="store"><a class="header-link" href="#store"></a><code>Store</code></h1>
<p>Base class used to create a contextual observable store.</p>
<p>Core concepts and capabilities include:</p>
<ul class="list">
<li>Be default store state is immutable (recommended).</li>
<li>Consumers can subscribe to store state changes via exposed RxJS Observables.</li>
<li>Store state change history can be captured and accessed (in memory only).</li>
<li>Store state changes can be logged to console.</li>
</ul>
<pre class="hljs"><code>
<span class="hljs-keyword">import</span> { Store } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@capitec/observable-store&#x27;</span>;
</code></pre><pre class="hljs"><code>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClientStore</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Store</span> </span>{
  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-built_in">super</span>({
      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;client-store&#x27;</span>,
      <span class="hljs-attr">persistence</span>: <span class="hljs-string">`sessionStorage`</span>
    });
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> ClientStore();
</code></pre><h2 id="instance-members"><a class="header-link" href="#instance-members"></a>Instance Members</h2>
<table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Example</th></tr></thead><tbody>
<tr><td>

<p><code>stateHistory</code></p>
</td><td>

<p><code>Array</code></p>
</td><td>Exposes store state history only if settings had "trackStateHistory: true" set.</td><td>



</td></tr>
<tr><td>

<p><code>stateChanged</code></p>
</td><td>

<p><code>Observable</code></p>
</td><td>Provides RxJS Observable that can be subscribed to in order to retrieve store changes.</td><td>



<pre class="hljs"><code>
<span class="hljs-comment">// Subscribe</span>
<span class="hljs-keyword">const</span> clientStoreSub = ClientStore.stateChanged.subscribe(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> {
  <span class="hljs-built_in">this</span>.clients = state &amp;&amp; state.clients ? state.clients : <span class="hljs-literal">null</span>;
});

<span class="hljs-comment">// Unsubscribe</span>
clientStoreSub.unsubscribe();
</code></pre></td></tr>
<tr><td>

<p><code>stateChangedWithName</code></p>
</td><td>

<p><code>Observable</code></p>
</td><td>Provides RxJS Observable that can be subscribed to in order to retrieve store changes and state name.</td><td>



<pre class="hljs"><code>
<span class="hljs-comment">// Subscribe</span>
<span class="hljs-keyword">const</span> clientStoreSub = ClientStore.stateChangedWithName.subscribe(<span class="hljs-function"><span class="hljs-params">changes</span> =&gt;</span> {
  <span class="hljs-built_in">this</span>.clients = changes.state &amp;&amp; changes.state.clients ? changes.state.clients : <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">const</span> stateAction = changes.name;
});

<span class="hljs-comment">// Unsubscribe</span>
clientStoreSub.unsubscribe();
</code></pre></td></tr>
<tr><td>

<p><code>stateChangedNoPayload</code></p>
</td><td>

<p><code>Observable</code></p>
</td><td>Provides RxJS Observable that can be subscribed to in order to be notified of store changes.</td><td>



<pre class="hljs"><code>
<span class="hljs-comment">// Subscribe</span>
<span class="hljs-keyword">const</span> clientStoreSub = ClientStore.stateChangedNoPayload.subscribe(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`State Changed`</span>)
});

<span class="hljs-comment">// Unsubscribe</span>
clientStoreSub.unsubscribe();
</code></pre></td></tr>
<tr><td>

<p><code>stateChangedNoPayloadWithName</code></p>
</td><td>

<p><code>Observable</code></p>
</td><td>Provides RxJS Observable that can be subscribed to in order to be notified of store changes with state name.</td><td>



<pre class="hljs"><code>
<span class="hljs-comment">// Subscribe</span>
<span class="hljs-keyword">const</span> clientStoreSub = ClientStore.stateChangedNoPayloadWithName.subscribe(<span class="hljs-function"><span class="hljs-params">name</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`State Changed: <span class="hljs-subst">${name}</span>`</span>);
});

<span class="hljs-comment">// Unsubscribe</span>
clientStoreSub.unsubscribe();
</code></pre></td></tr>
<tr><td>

<p><code>stateChangedProperties</code></p>
</td><td>

<p><code>Observable</code></p>
</td><td>Provides RxJS Observable that can be subscribed to in order to retrieve store changes,
includes properties that changed as well.</td><td>



<pre class="hljs"><code>
<span class="hljs-comment">// Subscribe</span>
<span class="hljs-keyword">const</span> clientStorePropertiesSub = ClientStore.stateChangedProperties.subscribe(<span class="hljs-function"><span class="hljs-params">changes</span> =&gt;</span> {
  <span class="hljs-built_in">this</span>.clients = changes.state &amp;&amp; changes.state.clients ? changes.state.clients : <span class="hljs-literal">null</span>;
});

<span class="hljs-comment">// Unsubscribe</span>
clientStorePropertiesSub.unsubscribe();
</code></pre></td></tr>
<tr><td>

<p><code>stateChangedPropertiesWithName</code></p>
</td><td>

<p><code>Observable</code></p>
</td><td>Provides RxJS Observable that can be subscribed to in order to retrieve store changes,
includes properties that changed as well as state name.</td><td>



<pre class="hljs"><code>
<span class="hljs-comment">// Subscribe</span>
<span class="hljs-keyword">const</span> clientStorePropertiesSub = ClientStore.stateChangedPropertiesWithName.subscribe(<span class="hljs-function"><span class="hljs-params">changes</span> =&gt;</span> {
  <span class="hljs-built_in">this</span>.clients = changes.state &amp;&amp; changes.state.clients ? changes.state.clients : <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">const</span> stateAction = changes.name;
});

<span class="hljs-comment">// Unsubscribe</span>
clientStorePropertiesSub.unsubscribe();
</code></pre></td></tr>
<tr><td>

<p><code>getStateChangedProperties</code></p>
</td><td>

<p>``</p>
</td><td></td><td>



</td></tr>
</tbody></table>

<h2 id="instance-functions"><a class="header-link" href="#instance-functions"></a>Instance Functions</h2>
<table><thead><tr><th>Name</th><th>Description</th><th>Parameters</th><th>Return</th><th>Example</th></tr></thead><tbody>
<tr><td>

<p><code>getState</code></p>
</td><td>Gets store state.</td><td>

<p>deepCloneReturnedState {<code>boolean</code>} - When true, returns a cloned copy of the store state (recommended).</p>
<p>NOTE: When false and the settings had &quot;persistence: &#39;memory&#39;&quot;, a reference to the store state will
be returned and it&#39;s up to the consumer to ensure the state isn&#39;t changed from the outside.</p>
</td><td>

<p>{<code>Object</code>} - Store state to return.</p>
</td><td>



</td></tr>
<tr><td>

<p><code>getStateProperty</code></p>
</td><td>Gets store state for a given property.</td><td>

<p>propertyName {<code>String</code>} - Name of the property to return from the store state.</p>
<p> deepCloneReturnedState {<code>Boolean</code>} - When true, returns a cloned copy of the store state (recommended).</p>
<p>NOTE: When false and the settings had &quot;persistence: &#39;memory&#39;&quot;, a reference to the store state will
be returned and it&#39;s up to the consumer to ensure the state isn&#39;t changed from the outside.</p>
</td><td>

<p>{<code>Object</code>} - Store state to return.</p>
</td><td>



</td></tr>
<tr><td>

<p><code>setState</code></p>
</td><td>Sets store state.

<p>NOTE: State to set MUST be serializable to and from JSON for immutability support
and / or supported persistence mechanisms.</td><td></p>
<p>state {<code>Object</code>|<code>function</code>} - State to set, can be an object or a function that accepts latest state as input parameter.</p>
<p> action {<code>String</code>} - Descriptive name for state action, e.g. &quot;CLIENT_ADD&quot;.</p>
<p> dispatchState {<code>Boolean</code>} - When true, notifies subscribers of state changes.</p>
<p> deepCloneState {<code>Boolean</code>} - When true, clones latest state before performing state update.</p>
</td><td>

<p>{<code>Object</code>} - Latest store state.</p>
</td><td>



</td></tr>
<tr><td>

<p><code>clearState</code></p>
</td><td>Clears store state.</td><td>

<p>dispatchState {<code>boolean</code>} - When true, notifies subscribers of state changes.</p>
</td><td>

<p>{<code>void</code>} - </p>
</td><td>



</td></tr>
<tr><td>

<p><code>resetState</code></p>
</td><td>Resets store state, includes clearing store state history.</td><td>

<p>state {<code>Object</code>} - State to set.</p>
<p> dispatchState {<code>boolean</code>} - When true, notifies subscribers of state changes.</p>
</td><td>

<p>{<code>void</code>} - </p>
</td><td>



</td></tr>
<tr><td>

<p><code>clearStateHistory</code></p>
</td><td>Clears store state history.</td><td>



</td><td>

<p>{<code>void</code>} - </p>
</td><td>



</td></tr>
</tbody></table>


<p class="img-container"><img src="https://raw.githubusercontent.com/andreasbm/readme/master/assets/lines/aqua.png" alt="-----------------------------------------------------"></p>
<h1 id="storestatesettings"><a class="header-link" href="#storestatesettings"></a><code>StoreStateSettings</code></h1>
<p>Settings for <a href="#store">Store</a> constructor.</p>
<h2 id="instance-members-1"><a class="header-link" href="#instance-members-1"></a>Instance Members</h2>
<table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Example</th></tr></thead><tbody>
<tr><td>

<p><code>persistence</code></p>
</td><td>

<p>``</p>
</td><td>[persistence="memory"] Where to persist store data to:
- "memory" - All state is stored in memory for the current session, i.e. it cannot survive page reloads.
- "sessionStorage" - All state is stored in domain storage for the current session only, i.e it can survive page reloads as long as the tab remains open.
- "localStorage" - All state is stored in local storage , i.e it can survive page reloads and browser reopen</td><td>



</td></tr>
<tr><td>

<p><code>trackStateHistory</code></p>
</td><td>

<p>``</p>
</td><td>[trackStateHistory=false] When true, stores the state mutation history.

<p>NOTE this will perpetually grow memory use within the current session and usage thereof
should be carefully considered, if needed at all.</td><td></p>
</td></tr>
<tr><td>

<p><code>logStateChanges</code></p>
</td><td>

<p>``</p>
</td><td>[logStateChanges=false] When true, logs the state mutation history to console.</td><td>



</td></tr>
</tbody></table>


<p class="img-container"><img src="https://raw.githubusercontent.com/andreasbm/readme/master/assets/lines/aqua.png" alt="-----------------------------------------------------"></p>
    </article>
  </body>
</html>
